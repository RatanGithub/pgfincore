SET search_path = public;

CREATE OR REPLACE FUNCTION
pgsysconf(OUT block_size   bigint,
          OUT block_free   bigint,
          OUT total_blocks bigint)
RETURNS record
AS 'MODULE_PATHNAME'
LANGUAGE C;

CREATE OR REPLACE FUNCTION
pgsysconf_pretty(OUT block_size   text,
                 OUT free_memory  text,
                 OUT total_memory text)
RETURNS record
AS '
select pg_size_pretty(block_size) as block_size,
       pg_size_pretty(block_free * block_size) as free_memory,
       pg_size_pretty(total_blocks * block_size) as total_memory
from pgsysconf()'
LANGUAGE SQL;







CREATE OR REPLACE FUNCTION
pgfincore(IN regclass,
		  IN text,
		  IN int)
RETURNS setof record
AS 'MODULE_PATHNAME'
LANGUAGE C;

CREATE OR REPLACE FUNCTION
pgmincore(IN regclass,
		  OUT relpath text,
		  OUT block_size bigint,
		  OUT block_disk bigint,
		  OUT block_mem bigint,
		  OUT group_mem bigint,
		  OUT data      varbit)
RETURNS setof record
AS 'SELECT pgfincore($1, ''main'', 10)'
LANGUAGE SQL;

CREATE OR REPLACE FUNCTION
pgmincore_snapshot(IN regclass,
		  OUT relpath text,
		  OUT block_size bigint,
		  OUT block_disk bigint,
		  OUT block_mem bigint,
		  OUT group_mem bigint,
		  OUT data      varbit)
RETURNS setof record
AS 'SELECT pgfincore($1, ''main'', 11)'
LANGUAGE SQL;

CREATE OR REPLACE FUNCTION
pgfadv_willneed(IN regclass,
				OUT relpath text,
				OUT block_size bigint,
				OUT block_disk bigint,
				OUT block_free bigint)
RETURNS setof record
AS 'SELECT pgfincore($1, ''main'', 20)'
LANGUAGE SQL;

CREATE OR REPLACE FUNCTION
pgfadv_willneed_snapshot(IN regclass,
				OUT relpath text,
				OUT block_size bigint,
				OUT block_disk bigint,
				OUT block_free bigint)
RETURNS setof record
AS 'SELECT pgfincore($1, ''main'', 21)'
LANGUAGE SQL;

CREATE OR REPLACE FUNCTION
pgfadv_dontneed(IN regclass,
				OUT relpath text,
				OUT block_size bigint,
				OUT block_disk bigint,
				OUT block_free bigint)
RETURNS setof record
AS 'SELECT pgfincore($1, ''main'', 30)'
LANGUAGE SQL;

CREATE OR REPLACE FUNCTION
pgfadv_normal(IN regclass,
			  OUT relpath text,
			  OUT block_size bigint,
			  OUT block_disk bigint,
			  OUT block_free bigint)
RETURNS setof record
AS 'SELECT pgfincore($1, ''main'', 40)'
LANGUAGE SQL;

CREATE OR REPLACE FUNCTION
pgfadv_sequential(IN regclass,
				  OUT relpath text,
				  OUT block_size bigint,
				  OUT block_disk bigint,
				  OUT block_free bigint)
RETURNS setof record
AS 'SELECT pgfincore($1, ''main'', 50)'
LANGUAGE SQL;

CREATE OR REPLACE FUNCTION
pgfadv_random(IN regclass,
			  OUT relpath text,
			  OUT block_size bigint,
			  OUT block_disk bigint,
			  OUT block_free bigint)
RETURNS setof record
AS 'SELECT pgfincore($1, ''main'', 60)'
LANGUAGE SQL;

